{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../state.js","../init.js","../src/index.js"],"sourcesContent":["export function observe(data) {\r\n  console.log(\"---observe---\");\r\n  if (typeof data !== \"object\" || data === null) return;\r\n\r\n  // 如果一个对象被劫持，那么久不需要再被劫持\r\n  // 可以增添一个实例，用实例来判断是否被劫持过\r\n\r\n  return new Observe(data);\r\n}\r\n\r\nclass Observe {\r\n  constructor(data) {\r\n    this.walk(data);\r\n  }\r\n  walk(data) {\r\n    Object.keys(data).forEach(key => defineReactive(data, key, data[key]));\r\n  }\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n  observe(value);\r\n  Object.defineProperty(target, key, {\r\n    get() {\r\n      return value;\r\n    },\r\n    set(newVal) {\r\n      if (value === newVal) return;\r\n      value = newVal;\r\n    }\r\n  });\r\n}\r\n","import { observe } from \"./src/observe/index\";\r\n\r\n\r\nexport function initState(vm){\r\n    const opts = vm.$options\r\n    if(opts.data){\r\n        console.log('执行opts.data')\r\n        initData(vm)\r\n    }\r\n}\r\n\r\n\r\nfunction initData(vm){\r\n    console.log('执行initDATA')\r\n    let data = vm.$options.data\r\n    data = typeof data === 'function' ? data.call(vm):data\r\n\r\n    vm._data = data\r\n    // 对数据进行观测\r\n    console.log('观测数据')\r\n    observe(data)\r\n\r\n    for(let key in data){\r\n        proxy(vm,'_data',key)\r\n    }\r\n}\r\n\r\nfunction proxy(vm,target,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[target][key]\r\n        },\r\n        set(newVal){\r\n            return vm[target][key] = newVal\r\n        }\r\n    })\r\n}\r\n","import { initState } from \"./state\";\r\n\r\nfunction initMixin(Vue) {\r\n  Vue.prototype._init = function(options) {\r\n    const vm = this;\r\n    vm.$options = options;\r\n    console.log('---执行initMixin---')\r\n    initState(vm);\r\n  };\r\n}\r\n\r\nexport default initMixin;\r\n","import initMixin from \"../init\";\r\n\r\nfunction Vue(options) {\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue);\r\n\r\nexport default Vue;\r\n"],"names":["observe","data","console","log","Observe","walk","Object","keys","forEach","key","defineReactive","target","value","defineProperty","get","set","newVal","initState","vm","opts","$options","initData","call","_data","proxy","initMixin","Vue","prototype","_init","options"],"mappings":"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"}